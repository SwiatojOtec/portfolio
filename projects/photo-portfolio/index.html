<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Фотограф Київ Панкрат'єв Михайло</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.11.1/baguetteBox.min.css">

    <style>
        .masonry-grid { column-count: 2; column-gap: 1rem; }
        .masonry-item { display: inline-block; width: 100%; margin-bottom: 1rem; break-inside: avoid; }
        @media (min-width: 768px) { .masonry-grid { column-count: 3; } }
        @media (min-width: 1280px) { .masonry-grid { column-count: 4; } }
        .submenu { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .submenu.open { max-height: 200px; }
        .chevron { transition: transform 0.3s ease-in-out; }
        .chevron.open { transform: rotate(90deg); }
        .mobile-sidebar { transform: translateX(-100%); transition: transform 0.3s ease-in-out; }
        .mobile-sidebar.open { transform: translateX(0); }
        .active-link { background-color: #f3f4f6; font-weight: 500; color: #1f2937; }

        #preloader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #f3f4f6; z-index: 1000; overflow: hidden; }
        .camera-loader { width: 150px; height: 150px; position: absolute; top: -200px; left: 50%; animation: fall-and-rotate 1.5s ease-out forwards; }
        @keyframes fall-and-rotate { 0% { top: -200px; transform: translateX(-50%) rotate(0deg); } 100% { top: 50%; transform: translateX(-50%) translateY(-50%) rotate(720deg); } }
        .lens-turn { animation: turn 0.5s linear 1.5s forwards; }
        @keyframes turn { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .flash { position: absolute; width: 300%; height: 300%; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border-radius: 50%; opacity: 0; animation: camera-flash 0.4s ease-out 2s forwards; }
        @keyframes camera-flash { 0% { transform: translate(-50%, -50%) scale(0); opacity: 0.8; } 100% { transform: translate(-50%, -50%) scale(1.5); opacity: 0; } }
        #preloader.fade-out { animation: fade-out 0.5s ease-out forwards; }
        @keyframes fade-out { from { opacity: 1; } to { opacity: 0; } }
        #main-content { opacity: 0; }
        #main-content.visible { animation: fade-in 0.8s ease-in forwards; }
        @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>

<body class="bg-gray-100 font-['Montserrat']">

    <div id="preloader">
        <div class="camera-loader">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="100%" height="100%">
                <rect width="256" height="256" fill="none"/>
                <circle cx="128" cy="132" r="40" fill="none" stroke="#333" stroke-linecap="round" stroke-linejoin="round" stroke-width="12" class="lens-turn" style="transform-origin: 128px 132px;"/>
                <circle cx="128" cy="132" r="12" fill="#333"/>
                <path d="M180,52H76a20,20,0,0,0-20,20v24" fill="none" stroke="#333" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/>
                <path d="M200,96h24a8,8,0,0,1,8,8v96a24,24,0,0,1-24,24H48a24,24,0,0,1-24-24V104a8,8,0,0,1,8-8H56" fill="none" stroke="#333" stroke-linecap="round" stroke-linejoin="round" stroke-width="12"/>
                <path d="M164,88a12,12,0,0,1,12-12h12a12,12,0,0,1,12,12v8a0,0,0,0,1,0,0H164a0,0,0,0,1,0,0Z" fill="#333"/>
            </svg>
            <div class="flash"></div>
        </div>
    </div>

    <div id="main-content">
        <button id="menu-toggle" class="lg:hidden fixed top-4 left-4 z-30 p-2 bg-white rounded-full shadow-md">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256"><path d="M224,128a8,8,0,0,1-8,8H40a8,8,0,0,1,0-16H216A8,8,0,0,1,224,128ZM40,88H216a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16ZM216,184H40a8,8,0,0,0,0,16H216a8,8,0,0,0,0-16Z"></path></svg>
        </button>
        <div id="menu-overlay" class="lg:hidden fixed inset-0 bg-black bg-opacity-50 z-10 hidden"></div>

        <div class="lg:flex">
            <aside id="sidebar" class="fixed top-0 left-0 h-screen w-64 bg-white shadow-md p-6 flex flex-col justify-between z-20 mobile-sidebar lg:transform-none lg:translate-x-0">
                <div>
                    <div class="mb-8">
                        <h1 class="text-2xl font-['Playfair_Display'] text-gray-800">Панкрат'єв Михайло</h1>
                        <p class="text-sm text-gray-500">Фотограф</p>
                    </div>
                    <!-- ВОССТАНОВЛЕННОЕ ПОЛНОЕ МЕНЮ -->
                    <nav class="flex flex-col space-y-1">
                        <a href="#" data-category="all" class="nav-link flex items-center gap-3 px-3 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors active-link">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256"><path d="M178,32c-20.65,0-38.73,8.88-50,23.89C116.73,40.88,98.65,32,78,32A62.07,62.07,0,0,0,16,94c0,70,103.79,126.66,108.21,129a8,8,0,0,0,7.58,0C136.21,220.66,240,164,240,94A62.07,62.07,0,0,0,178,32Zm14,54a6,6,0,0,1-12,0V78h-8a6,6,0,0,1,0-12h8V58a6,6,0,0,1,12,0v8h8a6,6,0,0,1,0,12h-8Z"></path></svg>
                            <span>Обране</span>
                        </a>
                        <div id="football-menu">
                            <button id="football-toggle" class="nav-link-parent w-full flex items-center justify-between gap-3 px-3 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                                <div class="flex items-center gap-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm48.26-120.73-10.82,31L136,112.55V88.33l29.46-20.15A72,72,0,0,1,176.26,95.27ZM114.73,68.18,144.19,88.33V112.55L114.73,144l-10.82-31ZM81.2,143.18,70.38,112.2l-29.46,20.15a72,72,0,0,1,7.21-27.09L81.2,118.82ZM90.38,48.82,120,69.18v23.74L90.38,76.45Zm-5.56,46.45-32.93,10.6,10.6-32.93,22.33,22.33ZM128,40a72.5,72.5,0,0,1,28.69,6.18L128,66.36,99.31,46.18A72.5,72.5,0,0,1,128,40Zm43.18,124.25-22.33-22.33,32.93-10.6-10.6,32.93ZM128,154.82l-28.69,20.18a72.5,72.5,0,0,1-22-22L106.82,142Zm34.35-47.57,22.33,22.33,10.6-32.93-32.93-10.6ZM128,216a72.5,72.5,0,0,1-28.69-6.18L128,189.64l28.69,20.18A72.5,72.5,0,0,1,128,216Zm37.67-15.08,22.33,22.33-10.6,32.93-32.93-10.6Z"></path></svg>
                                    <span>Футбол</span>
                                </div>
                                <svg id="football-chevron" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 256 256" class="chevron"><path d="M96,48V208l112-80Z"></path></svg>
                            </button>
                            <div id="football-submenu" class="submenu pl-8 pt-1">
                                <a href="#" data-category="futsal" class="nav-link block px-3 py-1.5 text-sm text-gray-600 rounded-lg hover:bg-gray-100">Футзал</a>
                                <a href="#" data-category="street" class="nav-link block px-3 py-1.5 text-sm text-gray-600 rounded-lg hover:bg-gray-100">Вуличний</a>
                                <a href="#" data-category="beach" class="nav-link block px-3 py-1.5 text-sm text-gray-600 rounded-lg hover:bg-gray-100">Пляжний</a>
                            </div>
                        </div>
                        <a href="#" data-category="photosession" class="nav-link flex items-center gap-3 px-3 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256"><path d="M208,56H180.28L166.65,35.56A8,8,0,0,0,160,32H96a8,8,0,0,0-6.65,3.56L75.71,56H48A24,24,0,0,0,24,80V192a24,24,0,0,0,24,24H208a24,24,0,0,0,24-24V80A24,24,0,0,0,208,56Zm-44,76a36,36,0,1,1-36-36A36,36,0,0,1,164,132Z"></path></svg>
                            <span>Фотосесія</span>
                        </a>
                    </nav>
                </div>
                <div class="flex flex-col space-y-2 text-sm">
                    <h3 class="px-3 text-xs text-gray-400 uppercase tracking-wider">
                        Контакти / <a href="about.html" class="hover:underline">Про мене</a>
                    </h3>
                    <a href="https://www.instagram.com/pank.ph/#" target="_blank" rel="noopener noreferrer" class="flex items-center gap-3 px-3 py-1 text-gray-600 rounded-lg hover:bg-gray-100 transition-colors">
                        <span>Instagram</span>
                    </a>
                    <a href="https://t.me/pank26" target="_blank" rel="noopener noreferrer" class="flex items-center gap-3 px-3 py-1 text-gray-600 rounded-lg hover:bg-gray-100 transition-colors">
                        <span>Telegram</span>
                    </a>
                    <div class="flex items-center gap-3 px-3 py-1 text-gray-600">
                        <span>+380 (67) 104-00-44</span>
                    </div>
                </div>
            </aside>

            <main class="lg:ml-64 p-4 sm:p-8 w-full">
                <div id="gallery-grid" class="masonry-grid">
                     <div class="text-center p-10 text-gray-500">Шукаю фотографії...</div>
                </div>
            </main>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.11.1/baguetteBox.min.js" async></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSy...",
            authDomain: "photo-pank-9a004.firebaseapp.com",
            projectId: "photo-pank-9a004",
            storageBucket: "photo-pank-9a004.appspot.com",
            messagingSenderId: "...",
            appId: "1:..."
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        const preloader = document.getElementById('preloader');
        const mainContent = document.getElementById('main-content');
        window.onload = function() {
            setTimeout(() => {
                preloader.classList.add('fade-out');
                mainContent.classList.add('visible');
                setTimeout(() => { preloader.style.display = 'none'; }, 500);
            }, 2500);
        };

        document.addEventListener('DOMContentLoaded', async function() {
            let allPhotos = [];
            const galleryGrid = document.getElementById('gallery-grid');
            const navLinks = document.querySelectorAll('.nav-link');
            const menuToggle = document.getElementById('menu-toggle');
            const sidebar = document.getElementById('sidebar');
            const menuOverlay = document.getElementById('menu-overlay');

            function renderGallery(filter = 'all') {
                galleryGrid.innerHTML = '';
                const filteredPhotos = (filter === 'all') ? allPhotos : allPhotos.filter(photo => photo.category === filter);
                if (filteredPhotos.length === 0) {
                     galleryGrid.innerHTML = '<div class="text-center p-10 text-gray-500">В цій категорії поки немає фотографій.</div>';
                     return;
                }
                filteredPhotos.forEach(photo => {
                    const captionText = photo.category_display || photo.category;
                    const photoElement = `<a href="${photo.url}" class="masonry-item" data-caption="Фото з категорії: ${captionText}"><img src="${photo.url}" alt="Фото з категорії: ${captionText}" class="rounded-lg shadow-md w-full h-auto object-cover transition-transform duration-300 hover:scale-105 hover:shadow-xl"></a>`;
                    galleryGrid.innerHTML += photoElement;
                });
                baguetteBox.run('#gallery-grid', { animation: 'fadeIn' });
            }

            async function fetchPhotos() {
                try {
                    const querySnapshot = await db.collection("photos").orderBy("timestamp", "desc").get();
                    allPhotos = [];
                    querySnapshot.forEach((doc) => { allPhotos.push(doc.data()); });
                    renderGallery('all');
                } catch (error) { console.error("Ошибка...", error); }
            }
            
            const footballToggle = document.getElementById('football-toggle');
            const footballSubmenu = document.getElementById('football-submenu');
            const footballChevron = document.getElementById('football-chevron');
            const footballParentLink = document.querySelector('#football-toggle');

            footballToggle.addEventListener('click', function() {
                footballSubmenu.classList.toggle('open');
                footballChevron.classList.toggle('open');
            });

            navLinks.forEach(link => {
                link.addEventListener('click', function(event) {
                    event.preventDefault();
                    document.querySelectorAll('.nav-link, .nav-link-parent').forEach(l => l.classList.remove('active-link'));
                    this.classList.add('active-link');
                    if (this.parentElement.id === 'football-submenu') {
                        footballParentLink.classList.add('active-link');
                    }
                    const category = this.dataset.category;
                    renderGallery(category);
                    if (window.innerWidth < 1024) {
                        sidebar.classList.remove('open');
                        menuOverlay.classList.add('hidden');
                    }
                });
            });

            menuToggle.addEventListener('click', function() {
                sidebar.classList.toggle('open');
                menuOverlay.classList.toggle('hidden');
            });
            menuOverlay.addEventListener('click', function() {
                sidebar.classList.remove('open');
                menuOverlay.classList.add('hidden');
            });

            await fetchPhotos();
        });
    </script>

</body>
</html>
